<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<title>The OCS/OASYS Mini-Tutorial</title>
</head>

<body bgcolor=FFFFFF>
<h3>Building and using application libraries with <code>ocs</code></h3>

Any number of Opal structures may be grouped together in a so-called
<em>subsystem</em> and referred to as a custom library.  (By
convention, a subsystem corresponds to a physical directory)

<h4>Creating a library</h4>

Consider a situation where you have written a number of related OPAL
structures dealing with that special <em>foo</em> data type you use
every day. Suppose these structures are called <code>Foo1</code>,
<code>Foo2</code> and <code>Foo3</code>. You might want to put these
structures in a subsystem <code>foo</code> so you have them at hand for
consistent refinement as well as easy access. You can do so by
following these steps:

<ol>

<li>Create a suitable subdirectory <code>foo</code>.
This might be somewhere in your
home directory - if your subsystem is private - or some other place, if
you want to share your code with others.

<li>Assume (after copying) that the six files (<code>Foo1.sign</code> through
<code>Foo3.impl</code>) reside in the (newly created)
<code>foo</code> directory.

<li>Create a file <code>SysDefs</code>
with the following contents (the example below uses <code>cat</code>, 
whose input is terminated by <code>^D</code>):

<p>
<pre>
$ cd foo
foo $ cat > SysDefs
SYSKIND=sub
NODENAME=foo
STRUCTS=Foo1 Foo2 Foo3
^D
foo $
</pre>

Note that it is important that the value assigned to NODENAME is equal to
the base name of the current directory.
</ol>

If you run <code>ocs</code> in the <code>foo</code> directory, a
library will be created (provided the Opal sources are
context-correct). This results in (a) new file(s) <code>libfoo.*</code> within
the subdirectory <code>foo/OCS</code>. 

<blockquote><small>Remark: by running 
<code>"ocs -sub foo Foo1,Foo2,Foo3"</code> 
a file <code>SysDefs.foo</code> will be created which can be renamed
<code>SysDefs</code>.
</small></blockquote>

<h4>Using application libraries</h4>

Let us assume that you intend to write a program (or a more complex
subsystem) based on two libraries <code>foo</code> and <code>bar</code> (which
have been created as above). Simply add the line(s)
<pre>
GENSUBSYS= \
  -s path-to-foo/foo \
  -s path-to-bar/bar \
  $(GENSTDSYS)
</pre>
to the corresponding <code>SysDefs</code> file.
<p>

If you have a whole hierarchy of libraries, these must be listed in a
top-down manner. Finally, the standard libraries
must be supplied by </code>$(GENSTDSYS)</code>.

<blockquote><small>Remark: inclusion of libraries can also be done via
<code>ocs</code> command-line options, e.g. 
<code>"ocs -top HelloWorld hello -s path-to-foo/foo -s path-to-bar/bar"</code>.

</small></blockquote> 

<p>


<hr>
<address><a href="mailto:opal@cs.tu-berlin.de">The Opal Group</a></address>
<!-- Created: Fri Oct 10 21:50:37 MET DST 1997 -->
<!-- hhmts start -->
Last modified:  Tue Nov 25 16:21:35 1997
<!-- hhmts end -->

</body>
</html>
